<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doğum Haritası | Astroloji</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<header>
    <h1>Doğum Haritası Hesaplama</h1>
    <p class="subtitle">Güneş, Ay ve Yükselen burcunu öğrenmek için bilgilerini gir.</p>
</header>

<section class="section">
    <div class="form-container">

        <label>Doğum Tarihi</label>
        <input type="date" id="tarih">

        <label>Doğum Saati</label>
        <input type="time" id="saat">

        <label>Doğum Yeri (Şehir)</label>
        <input type="text" id="sehir" placeholder="İstanbul, Ankara...">

        <a class="btn" onclick="haritaHesapla()">Haritamı Hesapla</a>
    </div>

    <div id="sonuc" style="margin-top:30px; font-size:20px; font-weight:bold; text-align:center;"></div>
</section>

<footer>
    © 2025 Astroloji Sitesi – Tüm Hakları Saklıdır
</footer>

<script>
// ✅ Google API ile şehir → koordinat
async function getCoordinates(city) {
    const apiKey = "AIzaSyBy841a3MU9lUkC5PM_X9uSkw3ok9rS4pY"; // ← BURAYA KENDİ API KEY’İNİ YAZ
    const url = `https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(city)}&key=${apiKey}`;

    const response = await fetch(url);
    const data = await response.json();

    if (data.status !== "OK") return null;

    return data.results[0].geometry.location;
}

// ✅ Güneş burcu hesaplama
function hesaplaGunes(tarih) {
    let ay = tarih.getMonth() + 1;
    let gun = tarih.getDate();
    let burc = "";

    if ((gun >= 21 && ay == 3) || (gun <= 20 && ay == 4)) burc = "Koç";
    else if ((gun >= 21 && ay == 4) || (gun <= 21 && ay == 5)) burc = "Boğa";
    else if ((gun >= 22 && ay == 5) || (gun <= 22 && ay == 6)) burc = "İkizler";
    else if ((gun >= 23 && ay == 6) || (gun <= 22 && ay == 7)) burc = "Yengeç";
    else if ((gun >= 23 && ay == 7) || (gun <= 22 && ay == 8)) burc = "Aslan";
    else if ((gun >= 23 && ay == 8) || (gun <= 22 && ay == 9)) burc = "Başak";
    else if ((gun >= 23 && ay == 9) || (gun <= 22 && ay == 10)) burc = "Terazi";
    else if ((gun >= 23 && ay == 10) || (gun <= 21 && ay == 11)) burc = "Akrep";
    else if ((gun >= 22 && ay == 11) || (gun <= 21 && ay == 12)) burc = "Yay";
    else if ((gun >= 22 && ay == 12) || (gun <= 21 && ay == 1)) burc = "Oğlak";
    else if ((gun >= 22 && ay == 1) || (gun <= 19 && ay == 2)) burc = "Kova";
    else if ((gun >= 20 && ay == 2) || (gun <= 20 && ay == 3)) burc = "Balık";

    return burc;
}

// ✅ Ay burcu hesaplama (astronomik formül)
function hesaplaAy(tarihSaat) {
    let jd = tarihSaat.getTime() / 86400000 + 2440587.5;
    let n = jd - 2451550.1;
    let L = (218.316 + 13.176396 * n) % 360;

    const burclar = [
        "Koç","Boğa","İkizler","Yengeç","Aslan","Başak",
        "Terazi","Akrep","Yay","Oğlak","Kova","Balık"
    ];

    return burclar[Math.floor(L / 30)];
}

// ✅ Yükselen burcu hesaplama
function hesaplaYukselen(tarihSaat, lat, lon) {
    let jd = tarihSaat.getTime() / 86400000 + 2440587.5;
    let T = (jd - 2451545.0) / 36525;

    let LST = (280.46061837 + 360.98564736629 * (jd - 2451545) + lon) % 360;
    if (LST < 0) LST += 360;

    let e = 23.4393 - 0.0000004 * T;

    let asc = Math.atan2(
        -Math.cos(LST * Math.PI/180),
        Math.sin(LST * Math.PI/180) * Math.cos(e * Math.PI/180) - Math.tan(lat * Math.PI/180) * Math.sin(e * Math.PI/180)
    ) * 180/Math.PI;

    if (asc < 0) asc += 360;

    const burclar = [
        "Koç","Boğa","İkizler","Yengeç","Aslan","Başak",
        "Terazi","Akrep","Yay","Oğlak","Kova","Balık"
    ];

    return burclar[Math.floor(asc / 30)];
}

// ✅ Ana hesaplama fonksiyonu
async function haritaHesapla() {
    let tarih = document.getElementById("tarih").value;
    let saat = document.getElementById("saat").value;
    let sehir = document.getElementById("sehir").value;

    if (!tarih || !saat || !sehir) {
        alert("Lütfen tüm bilgileri doldurun.");
        return;
    }

    let coords = await getCoordinates(sehir);
    if (!coords) {
        alert("Şehir bulunamadı.");
        return;
    }

    let tarihSaat = new Date(`${tarih}T${saat}`);

    let gunes = hesaplaGunes(tarihSaat);
    let ay = hesaplaAy(tarihSaat);
    let yukselen = hesaplaYukselen(tarihSaat, coords.lat, coords.lng);

    document.getElementById("sonuc").innerHTML =
        `Güneş Burcu: ${gunes}<br>Ay Burcu: ${ay}<br>Yükselen Burç: ${yukselen}`;
}
</script>

</body>
</html>
